{% macro _render_filter_fields(form) %}
    <div class="content-l_col
                content-l_col-1-2">
        <div class="o-form_group">
            <fieldset class="o-form_fieldset">
                <div class="m-form-field m-form-field__select">
                    <label class="a-label a-label__heading" for="id_geo">
                        Geographic area
                    </label>
                    <div class="a-select">
                        <select id="id_geo" name="geo">
                        {% for option in form.geo %}
                            <option value="{{ option.data.value }}"{% if option.data.selected %} selected{% endif %}>{{ option.choice_label }}</option>
                        {% endfor %}
                        </select>

                    </div>
                </div>
            </fieldset>
        </div>
    </div>
    <div class="content-l_col
                content-l_col-1">
        <div class="o-form_group">
            <fieldset class="o-form_fieldset">
                <legend class="a-legend">
                    Records included
                </legend>
               {% for radio in form.records %}
                  <div class="m-form-field m-form-field__radio m-form-field__lg-target">
                     <input class="a-radio" name="{{ radio.data.name }}" type="radio" id="{{ radio.id_for_label }}" value="{{ radio.data.value }}" {% if radio.data.selected %} checked{% endif %}>
                     <label class="a-label" for="{{ radio.id_for_label }}">{{ radio.choice_label }}</label>
                  </div>
               {% endfor %}
            </fieldset>
        </div>
        <div class="o-form_group">
            <fieldset class="o-form_fieldset">
                <legend class="a-legend">
                    Variable descriptions
                </legend>
               {% for radio in form.field_descriptions %}
                  <div class="m-form-field m-form-field__radio m-form-field__lg-target">
                     <input class="a-radio" name="{{ radio.data.name }}" type="radio" id="{{ radio.id_for_label }}" value="{{ radio.data.value }}" {% if radio.data.selected %} checked{% endif %}>
                     <label class="a-label" for="{{ radio.id_for_label }}">{{ radio.choice_label }}</label>
                  </div>
               {% endfor %}
            </fieldset>
        </div>
    </div>
{% endmacro %}

{% macro _filters_form(form) %}
    <form method="get" action=".">
        <div class="content-l">
            {{ _render_filter_fields(form) }}
            <div class="content-l_col
                        content-l_col-1
                        m-btn-group">
                <input class="a-btn"
                       type="submit"
                       value="Apply filters">
            </div>
        </div>
    </form>
{% endmacro %}

{# ==========================================================================

   HMDA Explorer Controls

   ==========================================================================

   Description:

   Create an expandable of filters when given:

   value: Data object from an instance of the FilterableList StreamField block.

   form: Django form that carries the fields that are to be rendered.

   fragment_id: A unique ID for the filter list control.

   ========================================================================== #}
{% macro render(value, form, fragment_id, has_active_filters) %}
    {% from 'organisms/expandable.html' import expandable with context %}
    <div id="{{ fragment_id }}" class="o-filterable-list-controls u-mb30">
        {% set form_markup = _filters_form(form) %}
        {% call() expandable(value) %}
            {{ form_markup | safe }}
        {% endcall %}
    </div>
{% endmacro %}
